drop table z_1.ent_0_t0;
drop table z_1.ent_0_t1;
drop table z_1.ent_0_t2;
drop table z_1.ent_0_t3;
drop table z_1.ent_0_t4;
drop table z_1.ent_0_t5;
drop table z_1.ent_0_t6;
drop table z_1.ent_0_t7;
drop table z_1.ent_0_t8;
drop table z_1.ent_0_t9;
drop table z_1.ent_0_t10;
drop table z_1.ent_0_t11;
drop table z_1.ent_0_t12;
drop table z_1.ent_0_t13;
drop table z_1.ent_0_t14;
drop table z_1.ent_0_t15;
drop table z_1.ent_0_t16;
drop table z_1.ent_0_t17;
drop table z_1.ent_0_t18;
drop table z_1.ent_0_t19;
drop table z_1.ent_0_t20;
drop table z_1.ent_0_t21;
drop table z_1.ent_0_t22;
drop table z_1.ent_0_t23;
drop table z_1.ent_0_t24;
drop table z_1.ent_0_t25;
drop table z_1.ent_0_t26;
drop table z_1.ent_0_t27;
drop table z_1.ent_0_t28;
drop table z_1.ent_0_t29;
drop table z_1.ent_0_t30;
drop table z_1.ent_0_t31;
drop table z_1.ent_0_t32;
drop table z_1.ent_0_t33;
drop table z_1.ent_0_t34;
drop table z_1.ent_0_t35;
drop table z_1.ent_0_t36;
drop table z_1.ent_0_t37;
drop table z_1.ent_0_t38;
drop table z_1.ent_0_t39;








create table z_1.ent_0_t0 as select * from z_1.ent_0 where entity_type_id=0;
create table z_1.ent_0_t1 as select * from z_1.ent_0 where entity_type_id=1;
create table z_1.ent_0_t2 as select * from z_1.ent_0 where entity_type_id=2;
create table z_1.ent_0_t3 as select * from z_1.ent_0 where entity_type_id=3;
create table z_1.ent_0_t4 as select * from z_1.ent_0 where entity_type_id=4;
create table z_1.ent_0_t5 as select * from z_1.ent_0 where entity_type_id=5;
create table z_1.ent_0_t6 as select * from z_1.ent_0 where entity_type_id=6;
create table z_1.ent_0_t7 as select * from z_1.ent_0 where entity_type_id=7;
create table z_1.ent_0_t8 as select * from z_1.ent_0 where entity_type_id=8;
create table z_1.ent_0_t9 as select * from z_1.ent_0 where entity_type_id=9;
create table z_1.ent_0_t10 as select * from z_1.ent_0 where entity_type_id=10;
create table z_1.ent_0_t11 as select * from z_1.ent_0 where entity_type_id=11;
create table z_1.ent_0_t12 as select * from z_1.ent_0 where entity_type_id=12;
create table z_1.ent_0_t13 as select * from z_1.ent_0 where entity_type_id=13;
create table z_1.ent_0_t14 as select * from z_1.ent_0 where entity_type_id=14;
create table z_1.ent_0_t15 as select * from z_1.ent_0 where entity_type_id=15;
create table z_1.ent_0_t16 as select * from z_1.ent_0 where entity_type_id=16;
create table z_1.ent_0_t17 as select * from z_1.ent_0 where entity_type_id=17;
create table z_1.ent_0_t18 as select * from z_1.ent_0 where entity_type_id=18;
create table z_1.ent_0_t19 as select * from z_1.ent_0 where entity_type_id=19;
create table z_1.ent_0_t20 as select * from z_1.ent_0 where entity_type_id=20;
create table z_1.ent_0_t21 as select * from z_1.ent_0 where entity_type_id=21;
create table z_1.ent_0_t22 as select * from z_1.ent_0 where entity_type_id=22;
create table z_1.ent_0_t23 as select * from z_1.ent_0 where entity_type_id=23;
create table z_1.ent_0_t24 as select * from z_1.ent_0 where entity_type_id=24;
create table z_1.ent_0_t25 as select * from z_1.ent_0 where entity_type_id=25;
create table z_1.ent_0_t26 as select * from z_1.ent_0 where entity_type_id=26;
create table z_1.ent_0_t27 as select * from z_1.ent_0 where entity_type_id=27;
create table z_1.ent_0_t28 as select * from z_1.ent_0 where entity_type_id=28;
create table z_1.ent_0_t29 as select * from z_1.ent_0 where entity_type_id=29;
create table z_1.ent_0_t30 as select * from z_1.ent_0 where entity_type_id=30;
create table z_1.ent_0_t31 as select * from z_1.ent_0 where entity_type_id=31;
create table z_1.ent_0_t32 as select * from z_1.ent_0 where entity_type_id=32;
create table z_1.ent_0_t33 as select * from z_1.ent_0 where entity_type_id=33;
create table z_1.ent_0_t34 as select * from z_1.ent_0 where entity_type_id=34;
create table z_1.ent_0_t35 as select * from z_1.ent_0 where entity_type_id=35;
create table z_1.ent_0_t36 as select * from z_1.ent_0 where entity_type_id=36;
create table z_1.ent_0_t37 as select * from z_1.ent_0 where entity_type_id=37;
create table z_1.ent_0_t38 as select * from z_1.ent_0 where entity_type_id=38;
create table z_1.ent_0_t39 as select * from z_1.ent_0 where entity_type_id=39;

SELECT projection_name,used_bytes/1024/1024 used_MB,ros_count FROM projection_storage where projection_name like 'ent_0_%' order by 2 desc;
SELECT sum(used_bytes)/1024/1024  FROM projection_storage where projection_name like 'ent_0_t%';

-- analyze just 100%
SELECT ANALYZE_HISTOGRAM ('z_1.ent_0',100);
SELECT ANALYZE_HISTOGRAM ('z_1.ent_0_t0',100);
SELECT ANALYZE_HISTOGRAM ('z_1.ent_0_t1',100);
SELECT ANALYZE_HISTOGRAM ('z_1.ent_0_t2',100);
-- analyze just 10%
SELECT ANALYZE_STATISTICS ('z_1.ent_0');
SELECT ANALYZE_STATISTICS ('z_1.ent_0_t0');
SELECT ANALYZE_STATISTICS ('z_1.ent_0_t1');
SELECT ANALYZE_STATISTICS ('z_1.ent_0_t2');

-- compare single table with multi table
explain 
--select o.entity_id,d.entity_id,o.entity_type_id,d.entity_type_id,o.r1
select count(1)
from z_1.ent_0 o,z_1.ent_0 d
where d.entity_id=o.r1
and d.entity_type_id=1;

explain 
--select o.entity_id,d.entity_id,o.entity_type_id,d.entity_type_id,o.r1
select count(1)
from z_1.ent_0_t2 o,z_1.ent_0_t1 d
where d.entity_id=o.r1
and d.entity_type_id=1;

alter table  z_1.relation_1 add column ts timestamp;
update z_1.relation_1 set ts=to_timestamp(last_update_time);
 ;
